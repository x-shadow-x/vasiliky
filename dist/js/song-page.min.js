function play(){$playBtnI.removeClass("icon-play").addClass("icon-pause"),iIncrement=iStartDeg-iEndDeg,controllArm.style.transform="rotate("+iStartDeg+"deg)",$cdCover.hasClass("cdPause")&&($cdCover.removeClass("cdPause"),$cdCover.removeClass("cdStart")),$cdCover.hasClass("cdStart")||$cdCover.addClass("cdStart"),myAudio.play()}function pause(){$playBtnI.removeClass("icon-pause").addClass("icon-play"),controllArm.style.transform="rotate(-130deg)",$cdCover.hasClass("cdPause")||$cdCover.addClass("cdPause"),myAudio.pause()}function initEventClick(){function s(){controllArm.style.transform="rotate(-130deg)",$cdCover.removeClass("cdPause"),$cdCover.removeClass("cdStart"),myAudio.load()}$playBtn.click(function(){$playBtnI.hasClass("icon-play")?play():pause()}),$nextBtn.click(function(){changeSong("next")}),$preBtn.click(function(){changeSong("pre")}),$stopBtn.click(s),$muteBtn.click(function(){$muteBtnI.hasClass("icon-volume-up")?$muteBtnI.removeClass("icon-volume-up").addClass("icon-volume-off"):$muteBtnI.removeClass("icon-volume-off").addClass("icon-volume-up"),myAudio.muted=!myAudio.muted,myAudio.muted?$(this).css({color:"red"}):$(this).css({color:"#b1b9c6"})}),$firstBtn.click(function(){changeSong("first")}),$lastBtn.click(function(){changeSong("last")}),$shuffleMode.click(function(){playMode="shuffle",$("#playMode").find("div").css({color:"#b1b9c6"}),$(this).css({color:"#e74d3c"})}),$listMode.click(function(){playMode="list",$("#playMode").find("div").css({color:"#b1b9c6"}),$(this).css({color:"#e74d3c"})}),$loopMode.click(function(){playMode="loop",$("#playMode").find("div").css({color:"#b1b9c6"}),$(this).css({color:"#e74d3c"})}),$muteBtn.hover(function(){myAudio.muted||$(this).css({color:"#ffffff"})},function(){$(this).css({color:"#b1b9c6"}),myAudio.muted&&$(this).css({color:"red"})})}function initComponents(){$playBtn=$("#playBtn"),$nextBtn=$("#nextBtn"),$preBtn=$("#preBtn"),$stopBtn=$("#stopBtn"),$muteBtn=$("#muteBtn"),$muteBtnI=$muteBtn.find("i").eq(0),$firstBtn=$("#firstBtn"),$lastBtn=$("#lastBtn"),$shuffleMode=$("#shuffleMode"),$listMode=$("#listMode"),$loopMode=$("#loopMode"),myAudio=$("#myAudio")[0],controllArm=$("#cdControllerArm")[0],$playBtnI=$playBtn.find("i").eq(0),$cdCover=$("#cdCover"),progressBar=$("#progressBar")[0],iStartDeg=-90,iEndDeg=-115,iIncrement=25,songsListIndex=0,playMode="list",$("#listMode").css({color:"#e74d3c"}),shuffleIndex=[],shuffleIndexCount=songsList.length-1,initShuffleGenerator()}function initShuffleGenerator(){for(var s=0;s<songsList.length;s++)shuffleIndex[s]=s}function init(){initComponents(),initEventClick()}function shuffle(){var s=getRandom(shuffleIndexCount),t=shuffleIndex[s];return shuffleIndex[s]=shuffleIndex[shuffleIndexCount],shuffleIndexCount--,0>shuffleIndexCount&&(shuffleIndexCount=songsList.length),t}function changeSong(s){0!=myAudio.currentTime&&(myAudio.paused||($cdCover.hasClass("cdPause")&&($cdCover.removeClass("cdPause"),$cdCover.removeClass("cdStart")),$cdCover.hasClass("cdStart")||$cdCover.addClass("cdStart"),controllArm.style.transform="rotate(-130deg)","pre"==s?(songsListIndex--,-1>=songsListIndex&&(songsListIndex=songsList.length)):"next"==s?(songsListIndex++,songsListIndex>=songsList.length+1&&(songsListIndex=0)):"first"==s?songsListIndex=0:"last"==s&&(songsListIndex=songsList.length-1),myAudio.src=decodeURI(songsList[songsListIndex].musicURL),myAudio.load(),myAudio.play()))}function getRandom(s){return Math.floor(Math.random()*s+1)}var $playBtn,$nextBtn,$preBtn,$stopBtn,$muteBtn,$firstBtn,$lastBtn,$shuffleMode,$listMode,$loopMode,myAudio,controllArm,$cdCover,iStartDeg,iEndDeg,iIncrement,songsListIndex,playMode,shuffleIndex,shuffleIndexCount,$playBtnI,$muteBtnI,progressBar;$().ready(function(){init();for(var s=0;s<songsList.length;s++)songsList[s].musicURL=encodeURI(songsList[s].musicURL);myAudio.src=decodeURI(songsList[songsListIndex].musicURL),myAudio.addEventListener("ended",function(){controllArm.style.transform="rotate(-130deg)","list"==playMode?(songsListIndex++,songsListIndex>=songsList.length+1&&(songsListIndex=0)):songsListIndex="shuffle"==playMode?shuffle():songsListIndex,myAudio.src=decodeURI(songsList[songsListIndex].musicURL),myAudio.load(),iStartDeg=-90,iEndDeg=-115,myAudio.play()},!1),myAudio.addEventListener("timeupdate",function(){var s=$("#myConsole");if(isNaN(myAudio.duration))s.text("error");else{var t=myAudio.currentTime/myAudio.duration;if(myAudio.paused)return;iStartDeg=-90-25*t,controllArm.style.transform="rotate("+iStartDeg+"deg)",s.text(songsList[songsListIndex%songsList.length].title+"-"+songsList[songsListIndex%songsList.length].artist);var e=100*t;progressBar.style.width=e+"%"}},!1)}),Number.prototype.toPercent=function(s){return s=s||2,(Math.round(this*Math.pow(10,s+2))/Math.pow(10,s)).toFixed(s)+"%"};var songsList=[{title:"行歌",artist:"陈鸿宇",coverURL:"",musicURL:"../../data/music/123.mp3"},{title:"行歌",artist:"陈鸿宇",coverURL:"",musicURL:"../../data/music/456.mp3"}];