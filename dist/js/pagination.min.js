module.directive("pagination",function(){return{templateUrl:"../../pagination.html",restrict:"E",replace:!0,transclude:!0,scope:{list:"=list",pagefn:"=pagefn",pageargs:"=pageargs"},controller:function($scope,$element,$attrs){$scope.$watch("pageargs",function(newValue,oldValue){newValue&&($scope.pageargs["switch"]=void 0,$scope.current=parseInt($scope.pageargs.pn)-1,$scope.pageNode=$scope.current,$scope.pNum=parseInt($scope.pageargs.ps),$scope.pMax=parseInt($scope.pageargs.pl)||5,$scope.pagefn($scope.pageargs,function(data){$scope.pLen=Math.ceil(parseInt(data.pa.total)/$scope.pNum),$scope.keyListWatch()}))},!0),$scope.reKeyList=function(s,e,limit){$scope.keyList=[];for(var i=s;i<e&&!(i>=limit);i++)$scope.hideEllipsis=i+1==$scope.pLen,$scope.keyList.push(i)},$scope.keyListWatch=function(){var pLen=$scope.pLen;if(pLen>$scope.pMax){var half=Math.ceil($scope.pMax/2),cur=$scope.current;cur>=half&&cur<pLen-($scope.pMax-half)?$scope.reKeyList(cur-($scope.pMax-half),cur+half,pLen):cur>=pLen-($scope.pMax-half)?$scope.reKeyList(pLen-$scope.pMax,pLen,pLen):cur<=half&&$scope.reKeyList(0,pLen,$scope.pMax)}else $scope.reKeyList(0,pLen,$scope.pMax)},$scope.jump=function(key){$scope.pageNode!=key&&($scope.current=key,$scope.pageNode=key,$scope.pageargs.pn=key+1)},$scope.next=function(){$scope.current++,$scope.current>=$scope.pLen&&($scope.current=$scope.pLen-1),$scope.jump($scope.current)},$scope.prev=function(){$scope.current--,$scope.current<=0&&($scope.current=0),$scope.jump($scope.current)},$scope.go=function(key){var regNum=/^-?\d+$/g;void 0==key||key.length<=0?alert("输入不能为空！"):regNum.test(key)?(parseInt(key)>$scope.pLen?(key=$scope.pLen,alert("总共只有"+$scope.pLen+"页，为您转到最后一页！")):parseInt(key)<=0&&(key=1,alert("不能低于第1页,为您转到最前一页！")),$scope.jump(parseInt(key)-1),$scope.goKey=void 0):key.match(/\s+/g)?alert("输入不能有空格符！"):alert("格式错误，请输入整数！")}}}});